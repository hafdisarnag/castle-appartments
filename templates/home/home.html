{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% load custom_filters %}
{% load custom_filters2 %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
<link rel="stylesheet" href="{% static 'css/property.css' %}">
<link rel="stylesheet" href="{% static 'css/openhouses.css' %}">
{% endblock %}

{% block content %}
    <div class="image-text-home">
        <img class="home-image" src="{% static 'images/home-mynd.jpeg' %}">
        <a href="{% url 'property-index' %}" class="dream-home">Find your dream home</a>
    </div>
    <h2 class="section-title">Recently listed</h2>
    <div class="main-container">
      <div class="properties-container" id="property-list">
        {% for property in featured_properties %}
          <div class="property-item">
            <form method="post" action="{% url 'toggle_favorite' property.id %}">
              {% csrf_token %}
              {% if user in property.favorites.all %}
                <button class="btn btn-sm btn-outline-danger">Unsave 🩷️</button>
              {% else %}
                <button class="btn btn-sm btn-outline-primary">Save 🤍</button>
              {% endif %}
            </form>
            <div class="property-image" style="background-image: url({{ property.images.first.image_url }})">
              <div class="property-type">{{ property.type }}</div>
            </div>
            <div class="property-info">
              <h3>{{ property.address }}</h3>
              <div class="zip-city">{{ property.zip }} {{ property.city }}</div>
            </div>
            <div class="line"></div>
            <div class="property-details">
              <div class="property-detail">📐 {{ property.size }} m²</div>
              <div class="property-detail">🛏 {{ property.rooms|floatformat:0 }}</div>
              <div class="property-detail">🛁 {{ property.bathrooms|floatformat:0 }}</div>
              <div class="property-detail">🛌 {{ property.bedrooms|floatformat:0 }}</div>
            </div>
            <div class="property-price">
              <div>{{ property.price|floatformat:0|intcomma|replace_comma }} kr.</div>
              <a href="{% url 'property-by-id' id=property.id %}">See more</a>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
    <div id="load-more-wrapper">
        <div class="load-more-line top"></div>
        <button id="load-more-btn">Load More Results</button>
        <div class="load-more-line bottom"></div>
    </div>
    {% include "open houses/openhouses.html" %}
    <script src="{% static 'js/load_more.js' %}"></script>
    <script src="{% static 'js/load_more_openhouses.js' %}"></script>
{% endblock %}
